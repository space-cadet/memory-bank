# T19: Memory Bank Viewer Web Interface
*Created: 2025-11-10 18:27:15 IST*
*Last Updated: 2025-11-13 22:50:00 IST*

**Description**: Design and implement a single-file HTML web interface for browsing memory bank contents with support for chronological (session timeline), task-wise (hierarchical), and topic-wise (semantic) browsing modes. Implementation uses dual file discovery approaches (scan script and server-based listing) to test both before deciding which to keep. Phase 2 adds individual file content viewer with chronological entry browsing.

**Status**: ðŸ”„ In Progress
**Priority**: HIGH
**Started**: 2025-11-10
**Last Active**: 2025-11-10 19:15:38 IST
**Dependencies**: None

## Completion Criteria
- [x] Complete planning and architecture design
- [x] Create viewer folder structure with viewer.html
- [x] Implement dual file discovery approaches (scan script and server-based)
- [x] Implement chronological view with session timeline
- [x] Implement task-wise hierarchical view with dependencies
- [x] Implement topic-wise semantic view with auto-extracted topics
- [x] Implement full-text search functionality
- [x] Implement filtering and navigation features
- [ ] Test both file discovery approaches
- [ ] Verify responsive design across browsers
- [x] Document usage instructions

## Related Files
- `implementation-details/memory-bank-viewer.md` - Complete planning and architecture documentation
- `viewer/viewer.html` - Main single-file viewer
- `viewer/server.js` - Minimal server for approach 2 (dynamic listing)
- `viewer/generate-manifest.js` - Scan script for approach 1 (static manifest)
- `viewer/manifest.json` - Auto-generated file listing
- `viewer/README.md` - Quick setup instructions

## Progress
1. âœ… Complete architecture planning and design
   - Designed dual approach implementation
   - Planned folder structure (memory-bank/viewer/)
   - Defined file discovery strategies
   - Created detailed plan document
2. âœ… Implementation Phase 1: Core infrastructure (COMPLETE - 2025-11-10 18:55 IST)
   - Created viewer/ folder structure
   - Implemented generate-manifest.js (240 lines) - Approach 1 scan script
   - Implemented server.js (280 lines) - Approach 2 dynamic server
   - Created viewer.html (1158 lines, now 1373 lines) with 9 embedded modules:
     * FileScanner - Process and group files by type
     * MarkdownParser - Extract frontmatter and parse markdown
     * DataIndexer - Build chronological, task, and topic indices
     * ChronologicalView - Timeline visualization
     * TaskWiseView - Hierarchical task tree
     * TopicWiseView - Topic hierarchy with related items
     * FileContentsView - File content parsing and rendering (NEW in Phase 2)
     * SearchEngine - Full-text search with ranking
     * UIController - Tab switching and interactions
   - Created launcher scripts (4 files) for both platforms
   - Created comprehensive README.md (430 lines)
   - Auto-generated manifest.json with 218 files indexed
   - All dependencies from CDN (no npm install needed)
   - Both file discovery approaches tested and working
3. ðŸ”„ Implementation Phase 2: Bug fixes and file content viewer (IN PROGRESS - started 2025-11-10 19:15 IST)
   - [x] Fix CORS error in approach 1 (static manifest)
     * Detect file:// protocol and skip server request
     * Fall back to manifest.json for file:// access
   - [x] Fix path resolution for approach 2 (server dynamic)
     * Added CONFIG.resolvePath() method
     * Converts relative paths to absolute server paths
   - [x] Fix search null reference error
     * Added null check in performSearch()
     * Prevents "can't access innerHTML" error
   - [x] Implement FileContentsView module (NEW)
     * parseEditHistory() - Chronological entry parsing
     * renderEditHistory() - Date-grouped rendering with expandable entries
   - [x] Add file contents browser tab (NEW)
     * Dropdown selector for edit_history.md, session_cache.md, errorLog.md
     * Real-time file loading with error handling
     * Chronological entry expansion for edit_history.md
   - [x] Add HTML escaping utility for safe file display
   - [x] Enhanced expandable entries with consistent UI
   - [ ] Test all bug fixes with both approaches
   - [ ] Expand file content viewer to session_cache.md and errorLog.md
4. â¬œ Implementation Phase 3: Advanced features (optional)
5. â¬œ Optimization and polish

## Architecture Overview

### Folder Structure
```
memory-bank/viewer/
â”œâ”€â”€ viewer.html                  (single file, all embedded, ~2000 lines)
â”œâ”€â”€ server.js                    (approach 2: minimal server, ~30 lines)
â”œâ”€â”€ generate-manifest.js         (approach 1: scan script, ~40 lines)
â”œâ”€â”€ manifest.json                (auto-generated by scan script)
â”œâ”€â”€ start-server.sh              (launcher for server approach)
â”œâ”€â”€ start-server.bat             (Windows launcher for server)
â”œâ”€â”€ start-scan.sh                (launcher for scan script approach)
â”œâ”€â”€ start-scan.bat               (Windows launcher for scan)
â”œâ”€â”€ README.md                    (quick setup instructions)
â””â”€â”€ package.json                 (minimal, no dependencies)
```

### Dual File Discovery Approaches

**Approach 1: Scan Script + Static Manifest**
- User runs: `./start-scan.sh`
- Generates manifest.json with all .md file metadata
- HTML loads manifest.json via fetch
- Best for: Static snapshots, portability, file:// access

**Approach 2: Server + Dynamic Listing**
- User runs: `./start-server.sh`
- Server provides /api/files endpoint with live file listing
- HTML calls /api/files on load
- Best for: Real-time updates, development, always fresh data

**Auto-detection in HTML:**
- Try /api/files first (server running?)
- Fall back to manifest.json (scan script run?)
- Show UI indicator of which mode is active
- Support manual switching if both available

### Core Features

**Three Browsing Modes:**
1. **Chronological View** - Timeline of sessions grouped by date/period
2. **Task-Wise View** - Hierarchical task tree with relationships
3. **Topic-Wise View** - Semantic topics with auto-extracted keywords

**Interactions:**
- Full-text search across all content
- Filter by status, priority, date range, topic
- Expandable/collapsible cards
- Click-through to file content preview
- Copy file paths to clipboard

**Technical Stack:**
- Vanilla JavaScript (no frameworks for simplicity)
- marked.js library (CDN) for markdown parsing
- TailwindCSS (CDN) for responsive styling
- YAML frontmatter parsing via regex
- In-memory caching of parsed files

### Implementation Strategy

**Phase 1: Core Infrastructure**
- Create folder structure
- Implement both file discovery approaches
- Set up HTML template with basic UI structure

**Phase 2: View Rendering**
- Implement file parsing (YAML + markdown)
- Build data indices (chronological, task, topic)
- Implement ChronologicalView with timeline
- Implement TaskWiseView with tree rendering
- Implement TopicWiseView with hierarchy

**Phase 3: Advanced Features**
- Implement full-text search engine
- Add filtering and faceted navigation
- Optimize performance (lazy rendering, caching)
- Add dark/light mode toggle
- Cross-browser testing

## Context

Planning session discussion with user about simplifying memory bank viewer to single HTML file with embedded dependencies. Chose approach 2 (embedded everything) with dual file discovery methods to test both before deciding which approach to standardize on. Key decisions:
- Single viewer.html file avoids clutter and build complexity
- Separate viewer/ folder keeps main memory-bank clean
- Dual approaches allow empirical testing and comparison
- No npm dependencies required (only CDN libraries)
- Works with both server and file:// access

## Related Work: T21 Explorer (Phase A Testing Infrastructure)

**Connection**: T21's Phase A testing created a similar HTML explorer for database browsing that builds on T19's foundational approach:

- **T19 Foundation**: Single-file HTML viewer with CDN libraries (viewer.html in viewer/ folder)
- **T21 Explorer**: Similar single-file HTML explorer (explorer.html in t21-workflow-testing/database/) for SQLite database browsing

**Key Similarities**:
- Both single-file HTML (no build required)
- Both use responsive design with CSS
- Both provide tabular and card view modes
- Both include search and filtering
- Both use vanilla JavaScript (no frameworks)

**T21 Explorer Enhancements**:
- Dark/light mode theming with CSS variables (transferable to T19)
- Dual view mode switching (Cards vs Tables) - concept proven for T21
- Per-table filtering and column sorting - could enhance T19
- State persistence across navigation using browser history API
- Primary key detection for related record navigation

**Potential Knowledge Transfer**:
- T21's CSS variable theming approach could improve T19's visual design
- T21's state persistence pattern could enhance T19's usability
- T21's view mode switching could be adapted for T19's different viewing modes
- Both explorers demonstrate the viability of single-file HTML for complex UIs

**Implementation Status**:
- T19: Phase 2 in progress (file content viewer, bug fixes)
- T21: Phase A complete with Phase B ready (database-native workflow)
- Both projects demonstrate effective approaches to memory bank data visualization

## Testing Notes
After implementation, user will:
1. Test approach 1 (scan script): Run ./start-scan.sh, open viewer.html locally
2. Test approach 2 (server): Run ./start-server.sh, open http://localhost:8000/viewer.html
3. Compare ease of use, file freshness, and portability
4. Keep one approach or both depending on preference
